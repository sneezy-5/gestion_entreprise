import{d as w,O as h,r as V,l as R,o as _,m as x,f as r,k as o,e as n,V as v,bS as b,i as l,p as S,bQ as T,Y as y,bc as $,aL as I,t as m,R as L,S as F,c as G}from"./index-54e10577.js";import{A as O,a as D}from"./caller.service-afc094da.js";import{c as A}from"./comptecompta.service-049e97fa.js";import{V as C,a as p}from"./VRow-b4fd1837.js";import{V as E}from"./VTextField-6bab4857.js";import{V as j}from"./VSelect-d3819a80.js";import{V as M}from"./VCounter-f481b6e6.js";import{V as N,a as P}from"./VPagination-c4475e8a.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import{a as Q}from"./VCard-9f617b6a.js";import"./VImg-17513cc0.js";import"./forwardRefs-a29b5f65.js";import"./VMenu-0d5d1b04.js";import"./index-1a500ab3.js";import"./ssrBoot-b02e1060.js";import"./VAvatar-d640487b.js";import"./VOverlay-0a4d3386.js";import"./lazy-c224c8a4.js";import"./easing-9f15041e.js";import"./dialog-transition-f581d50d.js";import"./VCheckboxBtn-ebf12b5d.js";let Y=d=>O.get("/grand-livre/?"+d);const q={getGrandlivreByfiter:Y},H=d=>(L("data-v-e6cff390"),d=d(),F(),d),J={class:"flex-start"},K={class:"flex-end"},W=H(()=>r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase text-center"}," Date de transaction "),r("th",{class:"text-uppercase text-center"}," Description "),r("th",{class:"text-uppercase text-center"}," Debit "),r("th",{class:"text-uppercase text-center"}," Crédit "),r("th",{class:"text-uppercase text-center"}," Montant ")])],-1)),X={class:"text-center"},Z={class:"text-center"},ee={class:"text-center"},te={class:"text-center"},ae={class:"text-xs-center"},k=5,oe=w({__name:"DemoSimpleTableDensityGrandlivre",setup(d){const t=h({start_date:new Date().toISOString().substr(0,10),end_date:new Date().toISOString().substr(0,10),account:null,formErrors:{start_date:!1,end_date:!1,account:!1}});V(0);const u=h([]);let i=V(1);const f=()=>{console.log(i),(i.value-1)*k;const s=`limit=${k}&page=${i.value}&start_date=${t.start_date}&end_date=${t.end_date}&account=${t.account}`;q.getGrandlivreByfiter(s).then(e=>{const a=e.data.results;t.formErrors.start_date=!1,t.formErrors.end_date=!1,t.formErrors.account=!1,u.pop(),u.push(e.data),console.log(u,a)}).catch(e=>{(e.status=401)&&(e.response.data.message?t.formErrors.account=!0:t.formErrors.account=!1)})},g=h([]);A.getListComptes().then(s=>{const e=s.data.data;for(let a=0;a<e.length;a++)g.push({abbr:e[a].id,state:e[a].name});console.log(s.data.data)}).catch(s=>{s.status=="401"&&console.error(s)}),f();const U=R(()=>{var s;return Math.ceil(((s=u[0])==null?void 0:s.count)/5)}),B=()=>{const s=`http://127.0.0.1:8000/api/v0/grand-livre/download-excel/?start_date=${t.start_date}&end_date=${t.end_date}&account=${t.account}`;fetch(s,{headers:{"Content-Type":"application/json",Authorization:"Bearer"+D.getToken(),database:D.getDatabase()}}).then(e=>e.blob()).then(e=>{const a=URL.createObjectURL(e),c=document.createElement("a");c.href=a,c.download="grand_livre.xlsx",c.click(),URL.revokeObjectURL(a)}).catch(e=>{console.error("Erreur lors du téléchargement du fichier :",e)})};return(s,e)=>(_(),x(y,null,[r("div",J,[o(b,{onClick:B,color:"success"},{default:n(()=>[o(v,{icon:"mdi-cloud-download"}),o(v,{icon:"mdi-microsoft-excel"})]),_:1})]),r("div",K,[o(M,{onSubmit:T(f,["prevent"])},{default:n(()=>[o(C,null,{default:n(()=>[o(p,{cols:"12",md:"6"},{default:n(()=>[o(E,{type:"date",modelValue:l(t).start_date,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).start_date=a),label:"Debut",placeholder:"Debut",error:l(t).formErrors.start_date},null,8,["modelValue","error"])]),_:1}),o(p,{cols:"12",md:"6"},{default:n(()=>[o(E,{type:"date",modelValue:l(t).end_date,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).end_date=a),label:"Fin",placeholder:"Fin",error:l(t).formErrors.end_date},null,8,["modelValue","error"])]),_:1}),o(p,{cols:"12",md:"6"},{default:n(()=>[o(j,{modelValue:l(t).account,"onUpdate:modelValue":e[2]||(e[2]=a=>l(t).account=a),label:"Comptes",items:l(g),"item-title":"state","item-value":"abbr","persistent-hint":"","single-line":"",error:l(t).formErrors.account},null,8,["modelValue","items","error"])]),_:1}),o(p,{cols:"12",class:"d-flex gap-4"},{default:n(()=>[o(b,{type:"submit"},{default:n(()=>[S(" Fltrer ")]),_:1}),o(b,{type:"reset",color:"secondary",variant:"tonal"},{default:n(()=>[S(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),o(N,{density:"compact"},{default:n(()=>{var a;return[W,r("tbody",null,[(_(!0),x(y,null,$((a=l(u)[0])==null?void 0:a.results,c=>(_(),x("tr",{key:c.id},[r("td",null,m(c.date),1),r("td",X,m(c.description),1),r("td",Z,m(c.debit),1),r("td",ee,m(c.credit),1),r("td",te,m(c.balance),1)]))),128))])]}),_:1}),r("div",ae,[o(P,{modelValue:l(i),"onUpdate:modelValue":e[3]||(e[3]=a=>I(i)?i.value=a:i=a),length:l(U),circle:"",onClick:f},null,8,["modelValue","length"])])],64))}});const re=z(oe,[["__scopeId","data-v-e6cff390"]]),ke=w({__name:"grandlivre",setup(d){return(t,u)=>(_(),G(C,null,{default:n(()=>[o(p,{cols:"12"},{default:n(()=>[o(Q,{title:"Grand livre"},{default:n(()=>[o(re)]),_:1})]),_:1})]),_:1}))}});export{ke as default};
