import{bU as B,d as w,ba as b,r as v,d8 as $,l as I,o as _,m as h,f as r,k as o,e as n,p as x,V as S,bV as V,i as l,bS as R,Z as y,be as F,aM as G,P as D,t as p,S as L,T as M,c as O}from"./index-548d44d1.js";import{V as C,a as m}from"./VRow-4f92fdd1.js";import{V as E}from"./VTextField-f85f9694.js";import{V as j}from"./VSelect-881b3fd7.js";import{V as A}from"./VCounter-3543cf5b.js";import{V as N,a as P}from"./VPagination-1ebcc86a.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import{a as Z}from"./VCard-fc59d69e.js";import"./VImg-a20b01d5.js";import"./forwardRefs-a29b5f65.js";import"./VMenu-528d0b92.js";import"./index-d9ad5dd9.js";import"./ssrBoot-595446f4.js";import"./VAvatar-2a93fb47.js";import"./VOverlay-3b2ac0ae.js";import"./lazy-4c34a0b5.js";import"./easing-9f15041e.js";import"./dialog-transition-ec6f11a2.js";import"./VCheckboxBtn-172bb155.js";let q=c=>B.get("/grand-livre/?"+c);const H={getGrandlivreByfiter:q},J=c=>(L("data-v-8bca9647"),c=c(),M(),c),K={class:"flex-start"},Q={class:"flex-end"},W=J(()=>r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase text-center"}," Date de transaction "),r("th",{class:"text-uppercase text-center"}," Description "),r("th",{class:"text-uppercase text-center"}," Debit "),r("th",{class:"text-uppercase text-center"}," Crédit "),r("th",{class:"text-uppercase text-center"}," Montant ")])],-1)),X={class:"text-center"},Y={class:"text-center"},ee={class:"text-center"},te={class:"text-center"},ae={class:"text-xs-center"},k=5,oe=w({__name:"DemoSimpleTableDensityGrandlivre",setup(c){const t=b({start_date:new Date().toISOString().substr(0,10),end_date:new Date().toISOString().substr(0,10),account:null,formErrors:{start_date:!1,end_date:!1,account:!1}});v(0);const u=b([]);let i=v(1);const f=()=>{console.log(i),(i.value-1)*k;const s=`limit=${k}&page=${i.value}&start_date=${t.start_date}&end_date=${t.end_date}&account=${t.account}`;H.getGrandlivreByfiter(s).then(e=>{const a=e.data.results;t.formErrors.start_date=!1,t.formErrors.end_date=!1,t.formErrors.account=!1,u.pop(),u.push(e.data),console.log(u,a)}).catch(e=>{(e.status=401)&&(e.response.data.message?t.formErrors.account=!0:t.formErrors.account=!1)})},g=b([]);$.getListComptes().then(s=>{const e=s.data.data;for(let a=0;a<e.length;a++)g.push({abbr:e[a].id,state:e[a].number});console.log(s.data.data)}).catch(s=>{s.status=="401"&&console.error(s)}),f();const U=I(()=>{var s;return Math.ceil(((s=u[0])==null?void 0:s.count)/5)}),T=()=>{const s=`http://127.0.0.1:8000/api/v0/grand-livre/download-excel/?start_date=${t.start_date}&end_date=${t.end_date}&account=${t.account}`;fetch(s,{headers:{"Content-Type":"application/json",Authorization:"Bearer"+D.getToken(),database:D.getDatabase()}}).then(e=>e.blob()).then(e=>{const a=URL.createObjectURL(e),d=document.createElement("a");d.href=a,d.download="grand_livre.xlsx",d.click(),URL.revokeObjectURL(a)}).catch(e=>{console.error("Erreur lors du téléchargement du fichier :",e)})};return(s,e)=>(_(),h(y,null,[r("div",K,[o(V,{onClick:T,color:"success"},{default:n(()=>[x("Exporter "),o(S,{icon:"mdi-cloud-download"}),o(S,{icon:"mdi-microsoft-excel"})]),_:1})]),r("div",Q,[o(A,{onSubmit:R(f,["prevent"])},{default:n(()=>[o(C,null,{default:n(()=>[o(m,{cols:"12",md:"6"},{default:n(()=>[o(E,{type:"date",modelValue:l(t).start_date,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).start_date=a),label:"Debut",placeholder:"Debut",error:l(t).formErrors.start_date},null,8,["modelValue","error"])]),_:1}),o(m,{cols:"12",md:"6"},{default:n(()=>[o(E,{type:"date",modelValue:l(t).end_date,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).end_date=a),label:"Fin",placeholder:"Fin",error:l(t).formErrors.end_date},null,8,["modelValue","error"])]),_:1}),o(m,{cols:"12",md:"6"},{default:n(()=>[o(j,{modelValue:l(t).account,"onUpdate:modelValue":e[2]||(e[2]=a=>l(t).account=a),label:"Comptes",items:l(g),"item-title":"state","item-value":"abbr","persistent-hint":"","single-line":"",error:l(t).formErrors.account},null,8,["modelValue","items","error"])]),_:1}),o(m,{cols:"12",class:"d-flex gap-4"},{default:n(()=>[o(V,{type:"submit"},{default:n(()=>[x(" Filtrer ")]),_:1}),o(V,{type:"reset",color:"secondary",variant:"tonal"},{default:n(()=>[x(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),o(N,{density:"compact"},{default:n(()=>{var a;return[W,r("tbody",null,[(_(!0),h(y,null,F((a=l(u)[0])==null?void 0:a.results,d=>(_(),h("tr",{key:d.id},[r("td",null,p(d.date),1),r("td",X,p(d.description),1),r("td",Y,p(d.debit),1),r("td",ee,p(d.credit),1),r("td",te,p(d.balance),1)]))),128))])]}),_:1}),r("div",ae,[o(P,{modelValue:l(i),"onUpdate:modelValue":e[3]||(e[3]=a=>G(i)?i.value=a:i=a),length:l(U),circle:"",onClick:f},null,8,["modelValue","length"])])],64))}});const re=z(oe,[["__scopeId","data-v-8bca9647"]]),De=w({__name:"grandlivre",setup(c){return(t,u)=>(_(),O(C,null,{default:n(()=>[o(m,{cols:"12"},{default:n(()=>[o(Z,{title:"Grand livre"},{default:n(()=>[o(re)]),_:1})]),_:1})]),_:1}))}});export{De as default};
