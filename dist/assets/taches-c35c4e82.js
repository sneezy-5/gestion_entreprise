import{d as P,r as C,O as y,l as Y,o as f,m as x,k as e,e as l,p as d,bS as m,i as c,aL as w,f as a,V as g,bQ as Z,Q as E,Y as R,bc as q,t as _,cZ as G,R as H,S as J,P as U,c as K}from"./index-54e10577.js";import{a as T}from"./caller.service-afc094da.js";import{t as A}from"./taches.service-c43238d7.js";import{p as W}from"./projet.service-8c51f1fc.js";import{a as $,b as X,V as ee,e as te}from"./VCard-9f617b6a.js";import{V as oe}from"./VDialog-d6bbd018.js";import{V as B,a as S}from"./VRow-b4fd1837.js";import{V as se}from"./VSelect-d3819a80.js";import{V as ae}from"./VCounter-f481b6e6.js";import{V as le,a as re}from"./VPagination-c4475e8a.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import"./VAvatar-d640487b.js";import"./VImg-17513cc0.js";import"./VOverlay-0a4d3386.js";import"./lazy-c224c8a4.js";import"./easing-9f15041e.js";import"./forwardRefs-a29b5f65.js";import"./dialog-transition-f581d50d.js";import"./VTextField-6bab4857.js";import"./VMenu-0d5d1b04.js";import"./index-1a500ab3.js";import"./ssrBoot-b02e1060.js";import"./VCheckboxBtn-ebf12b5d.js";const ne=h=>(H("data-v-0350bd4e"),h=h(),J(),h),de={class:"flex-start"},ie={key:0,class:"flex-end"},ue=ne(()=>a("thead",null,[a("tr",null,[a("th",{class:"text-uppercase"}," Titre "),a("th",{class:"text-uppercase text-center"}," Début "),a("th",{class:"text-uppercase text-center"}," Fin "),a("th",{class:"text-uppercase text-center"}," Projet "),a("th",{class:"text-uppercase text-center"}," Raport "),a("th",{class:"text-uppercase text-center"}," Progression "),a("th",{class:"text-uppercase text-center"}," Action ")])],-1)),pe={class:"text-center"},me={class:"text-center"},_e={class:"text-center"},fe={class:"text-center"},he={class:"text-center"},xe={class:"text-center"},Ve=["onClick"],ge=["onClick"],be={class:"text-xs-center"},L=5,ve=P({__name:"DemoSimpleTableDensityTache",setup(h){let b=C(0);const i=y([]),v=y([]),u=C(!1),I=o=>{b.value=o,u.value=!0},F=()=>{u.value=!1};let N=o=>{U.push({name:"edit-tache",params:{id:o}})},O=o=>{U.push({name:"edit-taches",params:{id:o}})};const n=y({project:"",formErrors:{project:!1}});W.getProjetList().then(o=>{const r=o.data.data;for(let t=0;t<r.length;t++)v.push({state:r[t].name,abbr:r[t].id});console.log(v)}).catch(o=>{o.status=="401"&&console.error(o)});let p=C(1);const V=()=>{console.log(p);const o=(p.value-1)*L,r=`limit=${L}&offset=${o}&project=${n.project}`;A.getAllTaches(r).then(t=>{const s=t.data.results;n.formErrors.project=!1,i.pop(),i.push(t.data),console.log(i[0].results,s)}).catch(t=>{(t.status="401")&&console.error(t),t.response.data.message?n.formErrors.project=!0:n.formErrors.project=!1})},M=()=>{A.deleteTache(b.value).then(o=>{V()}).catch(o=>{(o.status="401")&&console.error(o)}),u.value=!1};V();const Q=Y(()=>{var o;return Math.ceil(((o=i[0])==null?void 0:o.count)/5)}),j=T.getRole(),z=()=>{const o=`http://127.0.0.1:8000/api/v0/taches/download-excel/?start_date=${n.start_date}&end_date=${n.end_date}&account=${n.account}`;fetch(o,{headers:{"Content-Type":"application/json",Authorization:"Bearer"+T.getToken(),database:T.getDatabase()}}).then(r=>r.blob()).then(r=>{const t=URL.createObjectURL(r),s=document.createElement("a");s.href=t,s.download="taches.xlsx",s.click(),URL.revokeObjectURL(t)}).catch(r=>{console.error("Erreur lors du téléchargement du fichier :",r)})};return(o,r)=>(f(),x(R,null,[e(oe,{modelValue:c(u),"onUpdate:modelValue":r[0]||(r[0]=t=>w(u)?u.value=t:null),"max-width":"500px"},{default:l(()=>[e($,null,{default:l(()=>[e(X,{class:"headline"},{default:l(()=>[d("Confirmation de suppression")]),_:1}),e(ee,null,{default:l(()=>[d(" Êtes-vous sûr de vouloir supprimer ces données ? ")]),_:1}),e(te,null,{default:l(()=>[e(m,{onClick:M,style:{color:"red"}},{default:l(()=>[d("Confimer")]),_:1}),e(m,{onClick:F},{default:l(()=>[d("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",de,[e(m,{to:"/create-tache",style:{"margin-right":"10px"}},{default:l(()=>[d("Ajouter")]),_:1}),e(m,{onClick:z,color:"success"},{default:l(()=>[e(g,{icon:"mdi-cloud-download"}),e(g,{icon:"mdi-microsoft-excel"})]),_:1})]),c(j)=="true"?(f(),x("div",ie,[e(ae,{onSubmit:Z(V,["prevent"])},{default:l(()=>[e(B,null,{default:l(()=>[e(S,{cols:"12",md:"6"},{default:l(()=>[e(se,{modelValue:c(n).project,"onUpdate:modelValue":r[1]||(r[1]=t=>c(n).project=t),label:"Projets",items:c(v),"item-title":"state","item-value":"abbr","persistent-hint":"","single-line":"",error:c(n).formErrors.project},null,8,["modelValue","items","error"])]),_:1}),e(S,{cols:"12",class:"d-flex gap-4"},{default:l(()=>[e(m,{type:"submit"},{default:l(()=>[d(" Fltrer ")]),_:1}),e(m,{type:"reset",color:"secondary",variant:"tonal"},{default:l(()=>[d(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):E("",!0),e(le,{density:"compact"},{default:l(()=>{var t;return[ue,a("tbody",null,[(f(!0),x(R,null,q((t=c(i)[0])==null?void 0:t.results,s=>{var D;return f(),x("tr",{key:s.id},[a("td",null,_(s.title),1),a("td",pe,_(s.start_date),1),a("td",me,_(s.end_date),1),a("td",_e,_((D=s==null?void 0:s.project)==null?void 0:D.name),1),a("td",fe,_(s.rapport_taks),1),a("td",he,[e(G,{modelValue:s.progress,"onUpdate:modelValue":k=>s.progress=k,color:"success"},null,8,["modelValue","onUpdate:modelValue"]),d(" "+_(s.progess),1)]),a("td",xe,[a("button",{onClick:k=>c(j)=="true"?c(N)(s.id):c(O)(s.id)},[e(g,{icon:"mdi-edit"})],8,Ve),c(j)=="true"?(f(),x("button",{key:0,onClick:k=>I(s.id)},[e(g,{icon:"mdi-trash",style:{color:"red"}})],8,ge)):E("",!0)])])}),128))])]}),_:1}),a("div",be,[e(re,{modelValue:c(p),"onUpdate:modelValue":r[2]||(r[2]=t=>w(p)?p.value=t:p=t),length:c(Q),circle:"",onClick:V},null,8,["modelValue","length"])])],64))}});const je=ce(ve,[["__scopeId","data-v-0350bd4e"]]),Ze=P({__name:"taches",setup(h){return(b,i)=>(f(),K(B,null,{default:l(()=>[e(S,{cols:"12"},{default:l(()=>[e($,{title:"Taches"},{default:l(()=>[e(je)]),_:1})]),_:1})]),_:1}))}});export{Ze as default};
