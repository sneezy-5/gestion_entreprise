import{d as L,r as y,ba as C,db as q,l as G,P as T,o as u,m as x,k as e,e as l,p as n,bV as f,i as c,aM as w,f as a,c as B,R as S,V as b,bS as H,Z as R,be as J,dd as U,t as i,dc as K,S as W,T as X,Q as A}from"./index-bfa2d538.js";import{a as N,b as Y,V as ee,e as te}from"./VCard-7877ac97.js";import{V as se}from"./VDialog-5d8d2713.js";import{V as $,a as D}from"./VRow-18416828.js";import{V as oe}from"./VSelect-afd81524.js";import{V as ae}from"./VCounter-9deabfc9.js";import{V as le,a as re}from"./VPagination-5f021d48.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import"./VAvatar-b5327750.js";import"./VImg-d7e6df3b.js";import"./VOverlay-b657f991.js";import"./lazy-98d5b0cb.js";import"./easing-9f15041e.js";import"./forwardRefs-a29b5f65.js";import"./dialog-transition-44bf92b2.js";import"./VTextField-62f011eb.js";import"./VMenu-11b1e763.js";import"./index-c03b3b8a.js";import"./ssrBoot-b114fef2.js";import"./VCheckboxBtn-efb2e629.js";const ne=h=>(W("data-v-3a6104e2"),h=h(),X(),h),de={class:"flex-start"},ie={key:0,class:"flex-end"},ue=ne(()=>a("thead",null,[a("tr",null,[a("th",{class:"text-uppercase"}," Asigné "),a("th",{class:"text-uppercase"}," Titre "),a("th",{class:"text-uppercase text-center"}," Début "),a("th",{class:"text-uppercase text-center"}," Fin "),a("th",{class:"text-uppercase text-center"}," Projet "),a("th",{class:"text-uppercase text-center"}," Raport "),a("th",{class:"text-uppercase text-center"}," Progression "),a("th",{class:"text-uppercase text-center"}," Action ")])],-1)),pe={class:"text-center"},me={class:"text-center"},_e={class:"text-center"},fe={class:"text-center"},he={class:"text-center"},xe={class:"text-center"},Ve=["onClick"],ge=["onClick"],be={class:"text-xs-center"},P=5,ve=L({__name:"DemoSimpleTableDensityTache",setup(h){let v=y(0);const p=C([]),j=C([]),m=y(!1),I=s=>{v.value=s,m.value=!0},F=()=>{m.value=!1};let M=s=>{A.push({name:"edit-tache",params:{id:s}})},O=s=>{A.push({name:"edit-taches",params:{id:s}})};const d=C({project:"",formErrors:{project:!1}});q.getProjetList().then(s=>{const r=s.data.data;for(let t=0;t<r.length;t++)j.push({state:r[t].name,abbr:r[t].id});console.log(j)}).catch(s=>{s.status=="401"&&console.error(s)});let _=y(1);const V=()=>{console.log(_);const s=(_.value-1)*P,r=`limit=${P}&offset=${s}&project=${d.project}`;U.getAllTaches(r).then(t=>{const o=t.data.results;d.formErrors.project=!1,p.pop(),p.push(t.data),console.log(p[0].results,o)}).catch(t=>{(t.status="401")&&console.error(t),t.response.data.message?d.formErrors.project=!0:d.formErrors.project=!1})},z=()=>{U.deleteTache(v.value).then(s=>{V()}).catch(s=>{(s.status="401")&&console.error(s)}),m.value=!1};V();const Q=G(()=>{var s;return Math.ceil(((s=p[0])==null?void 0:s.count)/5)}),g=T.getRole(),Z=()=>{const s=`http://127.0.0.1:8000/api/v0/taches/download-excel/?project=${d.project}`;fetch(s,{headers:{"Content-Type":"application/json",Authorization:"Bearer"+T.getToken(),database:T.getDatabase()}}).then(r=>r.blob()).then(r=>{const t=URL.createObjectURL(r),o=document.createElement("a");o.href=t,o.download="taches.xlsx",o.click(),URL.revokeObjectURL(t)}).catch(r=>{console.error("Erreur lors du téléchargement du fichier :",r)})};return(s,r)=>(u(),x(R,null,[e(se,{modelValue:c(m),"onUpdate:modelValue":r[0]||(r[0]=t=>w(m)?m.value=t:null),"max-width":"500px"},{default:l(()=>[e(N,null,{default:l(()=>[e(Y,{class:"headline"},{default:l(()=>[n("Confirmation de suppression")]),_:1}),e(ee,null,{default:l(()=>[n(" Êtes-vous sûr de vouloir supprimer ces données ? ")]),_:1}),e(te,null,{default:l(()=>[e(f,{onClick:z,style:{color:"red"}},{default:l(()=>[n("Confimer")]),_:1}),e(f,{onClick:F},{default:l(()=>[n("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",de,[c(g)=="true"?(u(),B(f,{key:0,to:"/create-tache",style:{"margin-right":"10px"}},{default:l(()=>[n("Ajouter")]),_:1})):S("",!0),e(f,{onClick:Z,color:"success"},{default:l(()=>[n("Exporter "),e(b,{icon:"mdi-cloud-download"}),e(b,{icon:"mdi-microsoft-excel"})]),_:1})]),c(g)=="true"?(u(),x("div",ie,[e(ae,{onSubmit:H(V,["prevent"])},{default:l(()=>[e($,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[e(oe,{modelValue:c(d).project,"onUpdate:modelValue":r[1]||(r[1]=t=>c(d).project=t),label:"Projets",items:c(j),"item-title":"state","item-value":"abbr","persistent-hint":"","single-line":"",error:c(d).formErrors.project},null,8,["modelValue","items","error"])]),_:1}),e(D,{cols:"12",class:"d-flex gap-4"},{default:l(()=>[e(f,{type:"submit"},{default:l(()=>[n(" Fltrer ")]),_:1}),e(f,{type:"reset",color:"secondary",variant:"tonal"},{default:l(()=>[n(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):S("",!0),e(le,{density:"compact"},{default:l(()=>{var t;return[ue,a("tbody",null,[(u(!0),x(R,null,J((t=c(p)[0])==null?void 0:t.results,o=>{var E;return u(),x("tr",{key:o.id},[a("td",null,i(o.user.employee.firstName)+" "+i(o.user.employee.lastName),1),a("td",null,i(o.title),1),a("td",pe,i(o.start_date),1),a("td",me,i(o.end_date),1),a("td",_e,i((E=o==null?void 0:o.project)==null?void 0:E.name),1),a("td",fe,i(o.rapport_taks),1),a("td",he,[e(K,{modelValue:o.progress,"onUpdate:modelValue":k=>o.progress=k,color:"success"},null,8,["modelValue","onUpdate:modelValue"]),n(" "+i(o.progess),1)]),a("td",xe,[a("button",{onClick:k=>c(g)=="true"?c(M)(o.id):c(O)(o.id)},[e(b,{icon:"mdi-edit"})],8,Ve),c(g)=="true"?(u(),x("button",{key:0,onClick:k=>I(o.id)},[e(b,{icon:"mdi-trash",style:{color:"red"}})],8,ge)):S("",!0)])])}),128))])]}),_:1}),a("div",be,[e(re,{modelValue:c(_),"onUpdate:modelValue":r[2]||(r[2]=t=>w(_)?_.value=t:_=t),length:c(Q),circle:"",onClick:V},null,8,["modelValue","length"])])],64))}});const je=ce(ve,[["__scopeId","data-v-3a6104e2"]]),ze=L({__name:"taches",setup(h){return(v,p)=>(u(),B($,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(N,{title:"Taches"},{default:l(()=>[e(je)]),_:1})]),_:1})]),_:1}))}});export{ze as default};
