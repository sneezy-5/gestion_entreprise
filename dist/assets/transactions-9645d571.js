import{d as $,r as v,ba as D,l as N,o as V,m as y,k as t,e as s,p as i,bV as m,i as c,aM as T,f as e,V as x,bS as P,Z as k,be as z,da as S,P as w,t as d,S as J,T as Q,Q as Z,c as q}from"./index-548d44d1.js";import{a as A,b as G,V as H,e as K}from"./VCard-fc59d69e.js";import{V as W}from"./VDialog-76e8e84f.js";import{V as F,a as g}from"./VRow-4f92fdd1.js";import{V as E}from"./VTextField-f85f9694.js";import{V as X}from"./VCounter-3543cf5b.js";import{V as Y,a as tt}from"./VPagination-1ebcc86a.js";import{_ as et}from"./_plugin-vue_export-helper-c27b6911.js";import"./VAvatar-2a93fb47.js";import"./VImg-a20b01d5.js";import"./VOverlay-3b2ac0ae.js";import"./lazy-4c34a0b5.js";import"./easing-9f15041e.js";import"./forwardRefs-a29b5f65.js";import"./dialog-transition-ec6f11a2.js";import"./index-d9ad5dd9.js";const at=f=>(J("data-v-34f276d0"),f=f(),Q(),f),st={class:"flex-start"},ot={class:"flex-end"},nt=at(()=>e("thead",null,[e("tr",null,[e("th",{class:"text-uppercase"}," Type de transaction "),e("th",{class:"text-uppercase text-center"}," Compte "),e("th",{class:"text-uppercase text-center"}," Categorie "),e("th",{class:"text-uppercase text-center"}," Date de transaction "),e("th",{class:"text-uppercase text-center"}," Description "),e("th",{class:"text-uppercase text-center"}," Fournisseur "),e("th",{class:"text-uppercase text-center"}," Type depense "),e("th",{class:"text-uppercase text-center"}," Montant "),e("th",{class:"text-uppercase text-center"}," Action ")])],-1)),lt={class:"text-center"},rt={class:"text-center"},ct={class:"text-center"},dt={class:"text-center"},it={class:"text-center"},ut={class:"text-center"},pt={class:"text-center"},_t={class:"text-center"},mt=["onClick"],ft=["onClick"],ht={class:"text-xs-center"},U=5,xt=$({__name:"DemoSimpleTableDensityTransactions",setup(f){let b=v(0);const u=D([]),p=v(!1),I=l=>{b.value=l,p.value=!0},R=()=>{p.value=!1};let B=l=>{Z.push({name:"edit-transaction",params:{id:l}})};const r=D({start_date:new Date().toISOString().substr(0,10),end_date:new Date().toISOString().substr(0,10),account:null,formErrors:{start_date:!1,end_date:!1,account:!1}});let _=v(1);const h=()=>{console.log(_);const l=(_.value-1)*U,n=`limit=${U}&offset=${l}&start_date=${r.start_date}&end_date=${r.end_date}`;S.getAllTransactions(n).then(a=>{const o=a.data.results;u.pop(),u.push(a.data),console.log(u[0].results,o)}).catch(a=>{(a.status="401")&&console.error(a)})},L=()=>{S.deleteTransation(b.value).then(l=>{h()}).catch(l=>{(l.status="401")&&console.error(l)}),p.value=!1};h();const j=N(()=>{var l;return Math.ceil(((l=u[0])==null?void 0:l.count)/5)}),M=()=>{const l=`http://127.0.0.1:8000/api/v0/transaction/download-excel/?start_date=${r.start_date}&end_date=${r.end_date}&account=${r.account}`;fetch(l,{headers:{"Content-Type":"application/json",Authorization:"Bearer"+w.getToken(),database:w.getDatabase()}}).then(n=>n.blob()).then(n=>{const a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download="transactions.xlsx",o.click(),URL.revokeObjectURL(a)}).catch(n=>{console.error("Erreur lors du téléchargement du fichier :",n)})};return(l,n)=>(V(),y(k,null,[t(W,{modelValue:c(p),"onUpdate:modelValue":n[0]||(n[0]=a=>T(p)?p.value=a:null),"max-width":"500px"},{default:s(()=>[t(A,null,{default:s(()=>[t(G,{class:"headline"},{default:s(()=>[i("Confirmation de suppression")]),_:1}),t(H,null,{default:s(()=>[i(" Êtes-vous sûr de vouloir supprimer ces données ? ")]),_:1}),t(K,null,{default:s(()=>[t(m,{onClick:L,style:{color:"red"}},{default:s(()=>[i("Confimer")]),_:1}),t(m,{onClick:R},{default:s(()=>[i("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e("div",st,[t(m,{to:"/create-transaction",style:{"margin-right":"10px"}},{default:s(()=>[i("Ajouter")]),_:1}),t(m,{onClick:M,color:"success"},{default:s(()=>[t(x,{icon:"mdi-cloud-download"}),t(x,{icon:"mdi-microsoft-excel"})]),_:1})]),e("div",ot,[t(X,{onSubmit:P(h,["prevent"])},{default:s(()=>[t(F,null,{default:s(()=>[t(g,{cols:"12",md:"6"},{default:s(()=>[t(E,{type:"date",modelValue:c(r).start_date,"onUpdate:modelValue":n[1]||(n[1]=a=>c(r).start_date=a),label:"Debut",placeholder:"Debut",error:c(r).formErrors.start_date},null,8,["modelValue","error"])]),_:1}),t(g,{cols:"12",md:"6"},{default:s(()=>[t(E,{type:"date",modelValue:c(r).end_date,"onUpdate:modelValue":n[2]||(n[2]=a=>c(r).end_date=a),label:"Fin",placeholder:"Fin",error:c(r).formErrors.end_date},null,8,["modelValue","error"])]),_:1}),t(g,{cols:"12",class:"d-flex gap-4"},{default:s(()=>[t(m,{type:"submit"},{default:s(()=>[i(" Fltrer ")]),_:1}),t(m,{type:"reset",color:"secondary",variant:"tonal"},{default:s(()=>[i(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),t(Y,{density:"compact"},{default:s(()=>{var a;return[nt,e("tbody",null,[(V(!0),y(k,null,z((a=c(u)[0])==null?void 0:a.results,o=>{var C;return V(),y("tr",{key:o.id},[e("td",null,d(o.transaction_type),1),e("td",lt,d(o.account.name),1),e("td",rt,d(o.transaction_category),1),e("td",ct,d(o.transaction_date),1),e("td",dt,d(o.description),1),e("td",it,d((C=o==null?void 0:o.supplier)==null?void 0:C.name),1),e("td",ut,d(o.depense_category),1),e("td",pt,d(o.amount),1),e("td",_t,[e("button",{onClick:O=>c(B)(o.id)},[t(x,{icon:"mdi-edit"})],8,mt),e("button",{onClick:O=>I(o.id)},[t(x,{icon:"mdi-trash",style:{color:"red"}})],8,ft)])])}),128))])]}),_:1}),e("div",ht,[t(tt,{modelValue:c(_),"onUpdate:modelValue":n[3]||(n[3]=a=>T(_)?_.value=a:_=a),length:c(j),circle:"",onClick:h},null,8,["modelValue","length"])])],64))}});const Vt=et(xt,[["__scopeId","data-v-34f276d0"]]),Rt=$({__name:"transactions",setup(f){return(b,u)=>(V(),q(F,null,{default:s(()=>[t(g,{cols:"12"},{default:s(()=>[t(A,{title:"Journal"},{default:s(()=>[t(Vt)]),_:1})]),_:1})]),_:1}))}});export{Rt as default};
