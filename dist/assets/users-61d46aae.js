import{d as P,r as w,ba as N,l as z,o as g,m as C,k as e,e as t,p as d,bV as _,i as r,aM as k,f as l,bS as G,N as H,V as v,t as V,Z as A,be as J,bW as y,S as K,T as O,Q as X,c as Y}from"./index-548d44d1.js";import{a as D,b as M,V as ee,e as $}from"./VCard-fc59d69e.js";import{V as B}from"./VDialog-76e8e84f.js";import{V as te}from"./VCounter-3543cf5b.js";import{V as F,a as R}from"./VRow-4f92fdd1.js";import{V as se}from"./VTextField-f85f9694.js";import{V as oe}from"./VSnackbar-7e8d4438.js";import{V as le,a as ae}from"./VPagination-1ebcc86a.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";import"./VAvatar-2a93fb47.js";import"./VImg-a20b01d5.js";import"./VOverlay-3b2ac0ae.js";import"./lazy-4c34a0b5.js";import"./easing-9f15041e.js";import"./forwardRefs-a29b5f65.js";import"./dialog-transition-ec6f11a2.js";import"./index-d9ad5dd9.js";const re=h=>(K("data-v-b2868c14"),h=h(),O(),h),de={style:{"min-width":"700px","margin-left":"18px"}},ue={class:"flex-end"},ce=re(()=>l("thead",null,[l("tr",null,[l("th",{class:"text-uppercase"}," Employe "),l("th",{class:"text-uppercase text-center"}," Username "),l("th",{class:"text-uppercase text-center"}," Email "),l("th",{class:"text-uppercase text-center"}," Dernière connexion "),l("th",{class:"text-uppercase text-center"}," Action ")])],-1)),ie={class:"text-center"},pe={class:"text-center"},me={class:"text-center"},fe={class:"text-center"},_e=["onClick"],Ve=["onClick"],he=["onClick"],xe={class:"text-xs-center"},I=5,we=P({__name:"DemoSimpleTableDensityUser",setup(h){let c=w(0);const i=N([]),u=w({show:!1,text:"",color:""}),p=w(!1),x=w(!1),j=s=>{c.value=s,p.value=!0},L=s=>{c.value=s,x.value=!0},S=()=>{p.value=!1};let Q=s=>{X.push({name:"edit-user",params:{id:s}})},m=w(1);const b=()=>{console.log(m);const s=(m.value-1)*I,n=`limit=${I}&offset=${s}`;y.getAllUsers(n).then(o=>{const a=o.data.results;i.pop(),i.push(o.data),console.log(i[0].results,a)}).catch(o=>{(o.status="401")&&console.error(o)})},W=()=>{y.deleteUser(c.value).then(s=>{b()}).catch(s=>{(s.status="401")&&console.error(s)}),p.value=!1};b();const Z=z(()=>{var s;return Math.ceil(((s=i[0])==null?void 0:s.count)/5)}),f=N({newpassword:"",formErrors:{newpassword:!1}}),q=()=>{console.log(c),y.changePasswordUser(f,c.value).then(s=>{console.log(s),u.value={show:!0,text:"Modifié avec succès",color:"green"}}).catch(s=>{s.response.status==400&&console.error(s),s.response.data.newpassword?(f.formErrors.newpassword=!0,u.value={show:!0,text:s.response.data.newpassword,color:"red"}):f.formErrors.newpassword=!1}),x.value=!1};return(s,n)=>(g(),C(A,null,[e(B,{modelValue:r(p),"onUpdate:modelValue":n[0]||(n[0]=o=>k(p)?p.value=o:null),"max-width":"500px"},{default:t(()=>[e(D,null,{default:t(()=>[e(M,{class:"headline"},{default:t(()=>[d("Confirmation de suppression")]),_:1}),e(ee,null,{default:t(()=>[d(" Êtes-vous sûr de vouloir supprimer ces données ? ")]),_:1}),e($,null,{default:t(()=>[e(_,{onClick:W,color:"danger"},{default:t(()=>[d("Confimer")]),_:1}),e(_,{onClick:S},{default:t(()=>[d("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,{modelValue:r(x),"onUpdate:modelValue":n[2]||(n[2]=o=>k(x)?x.value=o:null),"max-width":"500px"},{default:t(()=>[e(D,null,{default:t(()=>[e(M,{class:"headline"},{default:t(()=>[d("Changer mot de passe")]),_:1}),l("div",de,[e(te,{onSubmit:G(q,["prevent"])},{default:t(()=>[e(F,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(se,{type:"text",modelValue:r(f).newpassword,"onUpdate:modelValue":n[1]||(n[1]=o=>r(f).newpassword=o),label:"Nouveau Mot de passe",placeholder:"Nouveau Mot de passe",error:r(f).formErrors.newpassword},null,8,["modelValue","error"])]),_:1})]),_:1}),e($,null,{default:t(()=>[e(_,{type:"submit",color:"danger"},{default:t(()=>[d("Confimer")]),_:1}),e(_,{onClick:S},{default:t(()=>[d("Annuler")]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1})]),_:1},8,["modelValue"]),e(oe,{modelValue:r(u).show,"onUpdate:modelValue":n[4]||(n[4]=o=>r(u).show=o),timeout:3e3,color:r(u).color,top:"top"},{action:t(({attrs:o})=>[e(_,H({text:""},o,{onClick:n[3]||(n[3]=a=>r(u).show=!1)}),{default:t(()=>[e(v,null,{default:t(()=>[d("mdi-close")]),_:1})]),_:2},1040)]),default:t(()=>[d(V(r(u).text)+" ",1)]),_:1},8,["modelValue","color"]),l("div",ue,[e(_,{to:"/create-user"},{default:t(()=>[d("Ajouter")]),_:1})]),e(le,{density:"compact"},{default:t(()=>{var o;return[ce,l("tbody",null,[(g(!0),C(A,null,J((o=r(i)[0])==null?void 0:o.results,a=>{var U,E;return g(),C("tr",{key:a.id},[l("td",null,V((U=a==null?void 0:a.employee)==null?void 0:U.firstName)+" "+V((E=a==null?void 0:a.employee)==null?void 0:E.lastName),1),l("td",ie,V(a.username),1),l("td",pe,V(a.email),1),l("td",me,V(a.last_login),1),l("td",fe,[l("button",{onClick:T=>r(Q)(a.id)},[e(v,{icon:"mdi-edit"})],8,_e),l("button",{onClick:T=>L(a.id)},[e(v,{icon:"mdi-key-outline"})],8,Ve),l("button",{onClick:T=>j(a.id)},[e(v,{icon:"mdi-trash",style:{color:"red"}})],8,he)])])}),128))])]}),_:1}),l("div",xe,[e(ae,{modelValue:r(m),"onUpdate:modelValue":n[5]||(n[5]=o=>k(m)?m.value=o:m=o),length:r(Z),circle:"",onClick:b},null,8,["modelValue","length"])])],64))}});const ve=ne(we,[["__scopeId","data-v-b2868c14"]]),Fe=P({__name:"users",setup(h){return(c,i)=>(g(),Y(F,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(D,{title:"Utilisateurs"},{default:t(()=>[e(ve)]),_:1})]),_:1})]),_:1}))}});export{Fe as default};
